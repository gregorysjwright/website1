<!DOCTYPE html>
<html>
<head>
	<title>Chat Website</title>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- Stylesheet -->
	<link rel="stylesheet" href="style.css">
	<!-- JavaScript -->
	<script type="module">
	// setup firebase
// Import the functions you need from the SDKs you need
import { initializeApp } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-app.js";
import { getDatabase, push, ref, get, onValue } from "https://www.gstatic.com/firebasejs/9.18.0/firebase-database.js";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries
// Your web app's Firebase configuration
const firebaseConfig = {
  apiKey: "AIzaSyCnpyh3MsPNIJRniNtiN0BuNhyVe5ImHVg",
  authDomain: "website-1-9cb6f.firebaseapp.com",
  projectId: "website-1-9cb6f",
  storageBucket: "website-1-9cb6f.appspot.com",
  messagingSenderId: "55103481924",
  appId: "1:55103481924:web:64fcfea9f2dd9ac586b411",
  databaseURL: "https://website-1-9cb6f-default-rtdb.firebaseio.com/",
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const database = getDatabase(app);

// firebase api chat box
const messageInput = document.getElementById("message-input");
const submitBtn = document.getElementById("submit-btn");
const messagesContainer = document.getElementById("messages");

const messageRef = ref(database, "messages");

submitBtn.addEventListener("click", () => {
  console.log("trying to send message")
  const message = messageInput.value;
  if (message) {
    // Save the message to Firebase Realtime Database
    console.log("trying to send message")
        push(messageRef, {
      "message": message,
      "timestamp": Date.now(),
      "sender": "user",
    })
      .then(() => {
        messageInput.value = "";
      })
      .catch((error) => {
        console.error("Error saving message", error);
      });
  }
});

// Fetch chat messages when the page loads and when new messages are added
onValue(messageRef, (snapshot) => {
  if (snapshot.exists()) {
    console.log(snapshot.val());
  } else {
    console.log("No data available");
  }
}, (error) => {
  console.error(error);
});



onValue(messageRef, (snapshot) => {
  const message = snapshot.val().message;
  const timestamp = snapshot.val().timestamp;
  const messageEl = document.createElement("div");
  messageEl.textContent = message;
  messagesContainer.appendChild(messageEl);
});

get(messageRef,"value")
  .then((snapshot) => {
    snapshot.forEach((childSnapshot) => {
      const message = childSnapshot.val().message;
      const messageEl = document.createElement("div");
      messageEl.textContent = message;
      messagesContainer.appendChild(messageEl);
    });
  })
  .catch((error) => {
    console.error("Error fetching messages", error);
  });



</script>
	<script src="script.js"></script>
</head>
<body>
	<header>
		<h1>Your Secret Admirer</h1>
	</header>
	
	<main>
	<p>Ready to unlock real-world gifts and reveal your secret admirer? Complete this series of games, each one revealing a juicy hint towards your mysterious suitor. And if you need a little help, chat with me in the chatbox â€“ I might respond!</p>		
		<div id="progress-bar">
    <a href="game1.html" id="link1"><span id="span1">&#x1F513</span></a> | 
    <a href="game2.html" id="link2" disabled><span id="span2">&#x1F512</span></a> | 
    <a href="prize1.html" class="prize" id="link3" disabled><span class="prize">&#x1F381</span></a> | 
    <a href="game3.html" id="link4" disabled><span id="span4">&#x1F512</span></a> | 
    <a href="game4.html" id="link5" disabled><span id="span5">&#x1F512</span></a> | 
    <a href="game5.html" id="link6" disabled><span id="span6">&#x1F512</span></a> | 
    <a href="prize2.html" class="prize" id="link7" disabled><span id="span7" class="prize">&#x1F381</span></a> | 
    <a href="game6.html" id="link8" disabled><span id="span8">&#x1F512</span></a> | 
    <a href="game7.html" id="link9" disabled><span id="span9">&#x1F512</span></a> | 
    <a href="win.html" class="win" id="link10" disabled><span  id="span10" class="win">&#x1F381</span></a>
</div>

<div id="chatbox-container">
			<p>As you progress through the games, know that I'm always here to guide you towards your ultimate reward. Your secret admirer awaits your call, ready to offer hints and solutions (within 3-5 business days).</p>
			<div id="chatbox" class="chat-log">
				<!-- Chat messages will be displayed here -->
			</div>
			<div class="chat-input" id="messages">
				<input type="text" id="message-input"  placeholder="Type your message here...">
				<button id="submit-btn">Send</button>
			</div>
		</div>

	</main>

	<footer>
		<p>&copy; 2023 Chat Website. All rights reserved.</p>
	</footer>
</body>
</html>

